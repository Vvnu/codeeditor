{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\thaku\\\\Desktop\\\\MC\\\\realtime-editor\\\\src\\\\components\\\\CodeEditor.jsx\",\n  _s = $RefreshSig$();\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { Box, HStack } from \"@chakra-ui/react\";\nimport { Editor } from \"@monaco-editor/react\";\nimport LanguageSelector from \"./LanguageSelector\";\nimport { CODE_SNIPPETS } from \"../constants\";\nimport Output from \"./Output\";\nimport { socket } from \"../socket\";\nimport PropTypes from 'prop-types';\nimport debounce from 'lodash/debounce';\n// import stripAnsi from 'strip-ansi'; // Add this line if you need stripAnsi\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CodeEditor = ({\n  roomId,\n  username\n}) => {\n  _s();\n  const editorRef = useRef(null);\n  const [value, setValue] = useState(CODE_SNIPPETS[\"python\"]);\n  const [language, setLanguage] = useState(\"python\");\n  const initialLoad = useRef(true);\n  const isReceivingUpdate = useRef(false);\n  const debouncedSend = useCallback(debounce(value => {\n    if (!isReceivingUpdate.current) {\n      socket.emit(\"send\", {\n        msg: value,\n        roomId,\n        username\n      });\n    }\n  }, 300), [roomId, username]);\n  const onMount = editor => {\n    editorRef.current = editor;\n    editor.focus();\n  };\n  const onSelect = selectedLanguage => {\n    setLanguage(selectedLanguage);\n    setValue(CODE_SNIPPETS[selectedLanguage]);\n    // Send language change to other users\n    socket.emit(\"send\", {\n      msg: CODE_SNIPPETS[selectedLanguage],\n      roomId,\n      username,\n      language: selectedLanguage\n    });\n  };\n  useEffect(() => {\n    if (initialLoad.current) {\n      initialLoad.current = false;\n      return;\n    }\n    debouncedSend(value);\n  }, [value, debouncedSend]);\n  useEffect(() => {\n    socket.on(\"receive\", data => {\n      isReceivingUpdate.current = true;\n      setValue(data.msg);\n\n      // Update language if it was changed by another user\n      if (data.language) {\n        setLanguage(data.language);\n      }\n\n      // Reset the flag after a short delay\n      setTimeout(() => {\n        isReceivingUpdate.current = false;\n      }, 100);\n    });\n    return () => {\n      socket.off(\"receive\");\n    };\n  }, []);\n  const handleInputChange = newValue => {\n    setValue(newValue);\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    children: /*#__PURE__*/_jsxDEV(HStack, {\n      spacing: 4,\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        w: \"50%\",\n        children: [/*#__PURE__*/_jsxDEV(LanguageSelector, {\n          language: language,\n          onSelect: onSelect\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Editor, {\n          options: {\n            minimap: {\n              enabled: false\n            }\n          },\n          height: \"100vh\",\n          theme: \"vs-dark\",\n          language: language,\n          defaultValue: CODE_SNIPPETS[language],\n          value: value,\n          onMount: onMount,\n          onChange: newValue => handleInputChange(newValue)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Output, {\n        editorRef: editorRef,\n        language: language\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s(CodeEditor, \"PiO8iqXoEUzNIkEx/0Wx7qSQg2A=\");\n_c = CodeEditor;\nCodeEditor.propTypes = {\n  roomId: PropTypes.string.isRequired,\n  username: PropTypes.string.isRequired\n};\nexport default CodeEditor;\nvar _c;\n$RefreshReg$(_c, \"CodeEditor\");","map":{"version":3,"names":["useCallback","useEffect","useRef","useState","Box","HStack","Editor","LanguageSelector","CODE_SNIPPETS","Output","socket","PropTypes","debounce","jsxDEV","_jsxDEV","CodeEditor","roomId","username","_s","editorRef","value","setValue","language","setLanguage","initialLoad","isReceivingUpdate","debouncedSend","current","emit","msg","onMount","editor","focus","onSelect","selectedLanguage","on","data","setTimeout","off","handleInputChange","newValue","children","spacing","w","fileName","_jsxFileName","lineNumber","columnNumber","options","minimap","enabled","height","theme","defaultValue","onChange","_c","propTypes","string","isRequired","$RefreshReg$"],"sources":["C:/Users/thaku/Desktop/MC/realtime-editor/src/components/CodeEditor.jsx"],"sourcesContent":["import { useCallback, useEffect, useRef, useState, } from \"react\";\nimport { Box, HStack } from \"@chakra-ui/react\";\nimport { Editor } from \"@monaco-editor/react\";\nimport LanguageSelector from \"./LanguageSelector\";\nimport { CODE_SNIPPETS } from \"../constants\";\nimport Output from \"./Output\";\nimport { socket } from \"../socket\";\nimport PropTypes from 'prop-types';\nimport debounce from 'lodash/debounce';\n// import stripAnsi from 'strip-ansi'; // Add this line if you need stripAnsi\n\nconst CodeEditor = ({ roomId, username }) => {\n  const editorRef = useRef(null);\n  const [value, setValue] = useState(CODE_SNIPPETS[\"python\"]);\n  const [language, setLanguage] = useState(\"python\");\n  const initialLoad = useRef(true);\n  const isReceivingUpdate = useRef(false);\n\n  const debouncedSend = useCallback(\n    debounce((value) => {\n      if (!isReceivingUpdate.current) {\n        socket.emit(\"send\", { msg: value, roomId, username });\n      }\n    }, 300), [roomId, username]\n  );\n\n  const onMount = (editor) => {\n    editorRef.current = editor;\n    editor.focus();\n  };\n\n  const onSelect = (selectedLanguage) => {\n    setLanguage(selectedLanguage);\n    setValue(CODE_SNIPPETS[selectedLanguage]);\n    // Send language change to other users\n    socket.emit(\"send\", { \n      msg: CODE_SNIPPETS[selectedLanguage], \n      roomId, \n      username,\n      language: selectedLanguage \n    });\n  };\n\n  useEffect(() => {\n    if (initialLoad.current) {\n      initialLoad.current = false;\n      return;\n    }\n    debouncedSend(value);\n  }, [value, debouncedSend]);\n\n  useEffect(() => {\n    socket.on(\"receive\", (data) => {\n      isReceivingUpdate.current = true;\n      setValue(data.msg);\n      \n      // Update language if it was changed by another user\n      if (data.language) {\n        setLanguage(data.language);\n      }\n      \n      // Reset the flag after a short delay\n      setTimeout(() => {\n        isReceivingUpdate.current = false;\n      }, 100);\n    });\n\n    return () => {\n      socket.off(\"receive\");\n    };\n  }, []);\n\n  const handleInputChange = (newValue) => {\n    setValue(newValue);\n  };\n\n  return (\n    <Box>\n      <HStack spacing={4}>\n        <Box w=\"50%\">\n          <LanguageSelector language={language} onSelect={onSelect} />\n          <Editor\n            options={{ minimap: { enabled: false } }}\n            height=\"100vh\"\n            theme=\"vs-dark\"\n            language={language}\n            defaultValue={CODE_SNIPPETS[language]}\n            value={value}\n            onMount={onMount}\n            onChange={(newValue) => handleInputChange(newValue)}\n          />\n        </Box>\n        <Output editorRef={editorRef} language={language} />\n      </HStack>\n    </Box>\n  );\n};\n\nCodeEditor.propTypes = {\n  roomId: PropTypes.string.isRequired,\n  username: PropTypes.string.isRequired,\n};\n\nexport default CodeEditor;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}